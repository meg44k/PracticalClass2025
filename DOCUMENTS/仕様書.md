# リアルタイムタイピング複数人対戦ゲーム(名前要検討)

- [概要](#概要)
- [要求定義](#要求定義)
- [要件定義](#要件定義)
- [必要ページ一覧](#必要ページ一覧)
- [画面遷移図](#画面遷移図)
- [データベース](#データベース)

## 概要
クラスメイト(50人程度)がタイピングのスコアをリアルタイムで競うWebアプリケーション

## 要求定義
- ユーザ登録がある
- 50人程度でマッチングを行う
- 対戦中は自分の順位や上位5人のランキングが表示される
- 対戦履歴が見れる

## 要件定義
- 授業で習ったためバックエンド言語としてphpを用いる
- phpでより簡単にwebアプリケーション開発を行うため、Webフレームワークであるlaravelを用いる
- データベースにはMySQLを用いる

## 設計
### 必要ページ一覧
--- 
- **タイトルページ**
    
    アクセスしたときに最初に見るページ。<br>
    タイトル、ユーザ登録、ログインなどがある

- **メインページ**

    対戦に参加するためのページ<br>
    対戦に参加するためのボタンがある<br>

- **マッチング待機ページ**

    マッチングボタンを押した後、試合開始まで待機するページ

- **対戦ページ**

    タイピング対戦が行われるページ<br>

- **リザルトページ**

    対戦結果を見るページ
    自分の順位と全体のランキングを表示する

- **マイページ**
    
    今までの戦績や対戦履歴などが見れるページ

- **セッティングページ**

    アカウント設定が行われるページ

- **ログインページ**
    
    ログインを行うページ

- **アカウント登録ページ**

    アカウント登録を行うページ


### 画面遷移図
---
![画面遷移図](./assets/画面遷移図.svg)

### データベース
---
### ユーザテーブル (Users)

| カラム名          | データ型          | 制約                                                   | 備考                                               |
| ----------------- | ----------------- | ------------------------------------------------------ | -------------------------------------------------- |
| `user_id`         | `BIGINT` | `PRIMARY KEY`, `AUTO_INCREMENT`, `NOT NULL`            | ユーザの一意な識別子                               |
| `user_name`       | `VARCHAR(255)`    | `NOT NULL`, `UNIQUE`                         | ユーザ名        |
| `user_password`   | `VARCHAR(255)`    | `NOT NULL`                                             | **ハッシュ化するべき**       |
| `created_at`      | `TIMESTAMP`       | `NOT NULL`, `DEFAULT CURRENT_TIMESTAMP`                | ユーザ登録日時                             |
| `updated_at`      | `TIMESTAMP`       | `NOT NULL`, `DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | ユーザ情報更新日時                         |

---

### 対戦テーブル (Games)

| カラム名                     | データ型          | 制約                                        | 備考                                     |
| ---------------------------- | ----------------- | ------------------------------------------- | ---------------------------------------- |
| `game_id`                    | `BIGINT` | `PRIMARY KEY`, `AUTO_INCREMENT`, `NOT NULL` | 対戦の一意な識別子                         |
| `played_at`                  | `TIMESTAMP`       | `NOT NULL`, `DEFAULT CURRENT_TIMESTAMP`                           | 対戦日時             |
| `actual_participant_count` | `INT`             | `NOT NULL`                                    | 実際の参加人数               |


---

### 対戦履歴テーブル (GameScores)

| カラム名                | データ型          | 制約                                                                 | 備考                                                         |
| ----------------------- | ----------------- | -------------------------------------------------------------------- | ------------------------------------------------------------ |
| `game_score_id`         | `INT` または `BIGINT` | `PRIMARY KEY`, `AUTO_INCREMENT`, `NOT NULL`                          | 対戦履歴の一意な識別子                                       |
| `game_id`               | `INT` または `BIGINT` | `NOT NULL`, `FOREIGN KEY REFERENCES Games(game_id)`                  | どの対戦か (`Games`テーブルへの参照)                         |
| `user_id`               | `INT` または `BIGINT` | `NOT NULL`, `FOREIGN KEY REFERENCES Users(user_id)`                  | どのユーザか (`Users`テーブルへの参照)                       |
| `score`                 | `INT`             | `NOT NULL`                                                           | スコア                                                       |
| `rank_in_game`          | `INT`             | `NOT NULL`                                                           | そのゲーム内でのランキング                                   |
| `type_count`     | `INT`             | `NOT NULL`, `DEFAULT 0`                                              | タイプ数                                                 |
| `missed_type_count`     | `INT`             | `NOT NULL`, `DEFAULT 0`                                              | ミスタイプ数                                                 |
|                         |                   | **`UNIQUE (game_id, user_id)`** | **1つのゲームに同じユーザが複数スコアを持てないようにする制約** |

---
